<!DOCTYPE html >
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Row Editor</title>
<link href="../scripts/easyui/themes/gray/easyui.css" rel="stylesheet" type="text/css" />
<link href="../icons/styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../scripts/jquery.min.js"></script>
<script type="text/javascript" src="../scripts/jquery.form.js"></script>
<script type="text/javascript" src="../scripts/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../scripts/easyui/locale/easyui-lang-zh_CN.js"></script>
<script type='text/javascript' src="../scripts/easyui/jquery.edatagrid.js"></script>
<script type='text/javascript' src="../scripts/glaf-base.js"></script>
<script type="text/javascript">
  
    var contextPath="/glaf";

    function submitForm(){
        var x_roles = jQuery("#x_roles").val();
	    var x_departments = jQuery("#x_departments").val();
	    var x_users = jQuery("#x_users").val();
        alert("选择的角色编号是："+x_roles);
	    alert("选择的部门编号是："+x_departments);
	    alert("选择的用户账号是："+x_users);

	    var params = jQuery("#iForm").formSerialize();
		jQuery.ajax({
				   type: "POST",
				   url: '',
				   dataType: 'json',
				   data: params,
				   error: function(data){
					   alert('服务器处理错误！');
				   },
				   success: function(data){
					   if(data != null && data.message != null){
						   alert(data.message);
					   } else {
						   alert('操作成功完成！');
					   }
				   }
			 });
    }

</script>
</head>
<body>
<form id="iForm" name="iForm" method="post"  > 
  <br>详细信息可以参考<a href="https://github.com/jior/glaf/blob/master/workspace/glaf-web/WebContent/WEB-INF/views/modules/sys/tree/showPerms.jsp"
  target="_blank">\WEB-INF\views\modules\sys\tree\showPerms.jsp</a>
  <br>显示及操作可以参考<a href="https://github.com/jior/glaf/blob/master/workspace/glaf-base/src/main/java/com/glaf/base/modules/sys/springmvc/SysTreeController.java"target="_blank">com.glaf.base.modules.sys.springmvc.SysTreeController.java</a>的showPerms及savePerms方法。
  <br>用户权限相关操作可以参考<a href="https://github.com/jior/glaf/blob/master/workspace/glaf-base/src/main/java/com/glaf/base/security/BaseIdentityFactory.java"target="_blank">com.glaf.base.security.BaseIdentityFactory.java</a>的方法。

  <table width="58%" align="center" border="0" cellspacing="0" cellpadding="5">
    <tr>
		<td height="27" width="20%" valign="middle" noWrap> 授权范围（角色）</td>
		<td height="27" valign="middle" noWrap> 
		<input type="hidden" id="x_roles" name="x_roles" value="">
        <textarea cols="40" id="x_roles_name" name="x_roles_name" rows="8"  wrap="yes" readonly  
		    style="height:100px;width:350px;color: #000066; background: #ffffff;"></textarea>
		</td>
		<td height="27" width="20%" valign="bottom" noWrap>
		    &nbsp;&nbsp;<input type="button" name="button" value="添加" class="button" 
			           onclick="javascript:selectRole('iForm', 'x_roles','x_roles_name');"> 
			<br><br>
			&nbsp;&nbsp;<input type="button" name="button" value="清空" class="button" 
			           onclick="javascript:clearSelected('x_roles','x_roles_name');"> 
		</td>
	</tr>
    <tr >
		<td height="27" width="20%" valign="middle" noWrap> 授权范围（部门）</td>
		<td height="27" valign="middle" noWrap> 
		<input type="hidden" id="x_departments" name="x_departments" value="">
        <textarea cols="40" id="x_departments_name" name="x_departments_name" rows="8"  wrap="yes" readonly  
		    style="height:100px;width:350px;color: #000066; background: #ffffff;"></textarea>
		</td>
		<td height="27" width="20%"   valign="bottom" noWrap>
		    &nbsp;&nbsp;<input type="button" name="button" value="添加" class="button" 
			           onclick="javascript:selectDept('iForm', 'x_departments','x_departments_name');"> 
			<br><br>
			&nbsp;&nbsp;<input type="button" name="button" value="清空" class="button"
			           onclick="javascript:clearSelected('x_departments','x_departments_name');"> 
		</td>
	</tr>
    <tr >
		<td height="27" width="20%" valign="middle" noWrap> 授权范围（用户）</td>
		<td height="27" valign="middle" noWrap> 
		<input type="hidden" id="x_users" name="x_users" value="">
        <textarea cols="40" id="x_users_name" name="x_users_name" rows="8"  wrap="yes" readonly  
		    style="height:100px;width:350px;color: #000066; background: #ffffff;"></textarea>
		</td>
		<td height="27" width="20%"  valign="bottom" noWrap>
		    &nbsp;&nbsp;<input type="button" name="button" value="添加" class="button" 
			           onclick="javascript:selectUser('iForm', 'x_users','x_users_name');"> 
			<br><br>
			&nbsp;&nbsp;<input type="button" name="button" value="清空" class="button" 
			           onclick="javascript:clearSelected('x_users','x_users_name');"> 
		</td>
	</tr>
  </table> 
  <div align="center">
      <br><br>
      <input type="button" name="button" value=" 确定 " class="button" onclick="javascript:submitForm();"> 
  </div>
 </form>
</body>
</html>